% !TEX root = ../../main.tex

\subsection{Modelo}\label{sec:04-acertijo-logico-modelo}

\subsubsection*{Parámetros}
\begin{description}
  \item[\textbf{P1 — \(\texttt{NOMBRE}\):}] Conjunto de personas: \(\{\texttt{Juan},\texttt{Oscar},\texttt{Dario}\}\).
  \item[\textbf{P2 — \(\texttt{AGE}\):}] Dominios de edad: \(\{24,25,26\}\).
  \item[\textbf{P3 — Códigos de apellidos:}] \(\{\texttt{GONZALEZ}=1,\ \texttt{GARCIA}=2,\ \texttt{LOPEZ}=3\}\).
  \item[\textbf{P4 — Códigos de música:}] \(\{\texttt{CLASICA}=1,\ \texttt{POP}=2,\ \texttt{JAZZ}=3\}\).
\end{description}

\subsubsection*{Variables}
\begin{description}
  \item[\textbf{V1 — \(\texttt{apellido}[n]\):}] Código de apellido de la persona \(n\), con dominio \(\{1,2,3\}\).
  \item[\textbf{V2 — \(\texttt{musica}[n]\):}] Género musical de la persona \(n\), con dominio \(\{1,2,3\}\).
  \item[\textbf{V3 — \(\texttt{edad}[n]\):}] Edad de la persona \(n\), con dominio \(\{24,25,26\}\).
\end{description}

\subsubsection*{Restricciones principales}
\begin{description}
  \item[\textbf{R1 — Biyectividad por atributo:}] No hay repeticiones dentro de cada atributo:
  \[
  \texttt{alldifferent}\big(\{\texttt{apellido}[n]\}\big),\quad
  \texttt{alldifferent}\big(\{\texttt{musica}[n]\}\big),\quad
  \texttt{alldifferent}\big(\{\texttt{edad}[n]\}\big).
  \]
  \item[\textbf{R2 — Pistas del acertijo:}] Se expresan como implicaciones índice–valor:
  \[
  (\texttt{apellido}[n]=\texttt{GONZALEZ})\Rightarrow \texttt{edad}[\texttt{Juan}]>\texttt{edad}[n],\ \forall n
  \]
  \[
  (\texttt{apellido}[n]=\texttt{GONZALEZ})\Rightarrow \texttt{musica}[n]=\texttt{CLASICA},\ \forall n
  \]
  \[
  (\texttt{musica}[n]=\texttt{POP})\Rightarrow \texttt{apellido}[n]\neq \texttt{GARCIA},\ \forall n
  \]
  \[
  (\texttt{musica}[n]=\texttt{POP})\Rightarrow \texttt{edad}[n]\neq 24,\ \forall n
  \]
  \[
  \texttt{apellido}[\texttt{Oscar}]\neq \texttt{LOPEZ},\quad
  \texttt{edad}[\texttt{Oscar}]=25,\quad
  \texttt{musica}[\texttt{Dario}]\neq \texttt{JAZZ}.
  \]
\end{description}

\subsubsection*{Justificación del modelo}
El modelo es \textbf{correcto y completo} respecto al acertijo. Es correcto porque: (i) los dominios codifican exactamente los valores admitidos (apellidos, música y edades), (ii) \texttt{alldifferent} garantiza la \emph{biyectividad} persona–valor en cada atributo, como exige el enunciado, y (iii) cada pista se traduce mediante implicaciones índice–valor semánticamente equivalentes (p.\,ej., \(\texttt{GONZALEZ}\Rightarrow\texttt{CLASICA}\), \(\texttt{POP}\Rightarrow\texttt{apellido}\neq\texttt{GARCIA}\), \(\texttt{edad}[\texttt{Oscar}]=25\)), de modo que toda solución del CSP satisface el acertijo. Es completo (\emph{complete}) porque cualquier solución válida del acertijo puede representarse en el modelo: basta mapear las etiquetas a sus códigos enteros y se satisfacen dominios, \texttt{alldifferent} y las implicaciones; por lo tanto, ninguna solución real queda fuera. La codificación entera es puramente \emph{representacional} (no añade ni elimina soluciones) y el mapeo inverso asegura salida legible. En conjunto, la combinación de dominios precisos, \texttt{alldifferent} y las pistas formalizadas elimina asignaciones espurias y, cuando el enunciado determina una única solución, el modelo también la vuelve única.

\subsubsection*{Restricciones redundantes}
No se añadieron restricciones redundantes en la versión final, ya que la combinación de \texttt{alldifferent} y las pistas es suficiente para fijar la solución en este tamaño de instancia. En pruebas internas, \(\texttt{count}\) sobre valores específicos y la suma fija de edades no aportaron mejoras apreciables de tiempo ni de nodos/fallos, por lo que se priorizó la \emph{simplicidad del modelo}.

\subsubsection*{Estrategia de búsqueda}
Se concatena el vector de decisión \(\texttt{vars}\) y se usa una heurística reproducible y fuertemente propagante:
\[
\texttt{int\_search}(\texttt{vars},\ \texttt{dom\_w\_deg},\ \texttt{indomain\_split},\ \texttt{complete}).
\]
\paragraph{Justificación de la estrategia}
\begin{itemize}
  \item \textbf{Selección de variable (\(dom\_w\_deg\))}. Prioriza variables con \emph{dominio pequeño} y \emph{alto grado de conflicto} (ponderado por restricciones que ya han fallado). En este acertijo, las variables de \texttt{apellido}, \texttt{musica} y \texttt{edad} están conectadas por \texttt{alldifferent} e implicaciones reificadas; atacar primero las más “tensas” maximiza la poda temprana.
  \item \textbf{Selección de valor (\(indomain\_split\))}. Partir el dominio activa más propagación que probar un solo valor (\emph{min}) porque fuerza una dicotomía global: la mitad inferior frente a la superior. Con dominios pequeños (\(\{1,2,3\}\) o \(\{24,25,26\}\)), cada corte dispara propagación en \texttt{alldifferent} y en las implicaciones (p.~ej., \(\texttt{GONZALEZ}\Rightarrow\texttt{CLASICA}\)).
  \item \textbf{Menos retrocesos, menor profundidad}. La combinación \(\texttt{dom\_w\_deg}+\texttt{split}\) reduce \textit{nodes}/\textit{fail} y la \textit{peakDepth} al resolver primero los cuellos de botella y descartar ramas imposibles antes de comprometer valores concretos.
\end{itemize}